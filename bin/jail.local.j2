[DEFAULT]
bantime = 3600       # Ban hosts for one hour:
findtime = 600       # 10 minutes
maxretry = 5         # Number of retries before ban
dbpurgeage = 86400   # 24 hours

# Override /etc/fail2ban/jail.d/00-firewalld.conf:
banaction = iptables-multiport
mta = sendmail
protocol = tcp

# Default name of the action.  (multiport for multiport options)
action = %(action_mw)s

# Monitor SSH logins:
[sshd]
enabled = true
port = ssh
maxretry = 5
findtime = 600
bantime = 3600
logpath = /var/log/auth.log
backend = systemd

# Protect against excessive 404s, bad bots, or unauthorized login attempts.
[nginx-404]
enabled = true
filter = nginx-botsearch
logpath = /var/log/nginx/*.log
maxretry = 10
findtime = 600
bantime = 3600

# Protect against excessive http/https 404s, bad bots, or unauthorized login attempts.
[nginx-bots]
enabled  = true
port     = http,https
filter   = nginx-bots
logpath  = /var/log/nginx/access.log
maxretry = 1
bantime  = 86400  # Time in seconds to ban the IP (1 day)
findtime = 600    # Time window for maxretry (10 minutes)
action   = iptables[name=NGINX-BOTS, port=http, protocol=tcp]

[nginx]
enabled = true
filter = nginx-http-auth
port = http,https
logpath = /var/log/nginx/*.log
maxretry = 3
bantime = 600

# If an IP gets banned multiple times, ban it longer
[recidive]
enabled = true
logpath = /var/log/fail2ban.log
findtime = 86400
bantime = 604800  # Ban for a week
maxretry = 5

